<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="image.png" type="image/png" />
    <title>Simulado - Atua√ß√£o do Bombeiro Diante de Desastres</title>
    <meta name="theme-color" content="#38bdf8" />

    <!-- <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("sw.js")
          .then(() => console.log("Service Worker registrado"))
          .catch((err) => console.error("SW erro:", err));
      }
    </script> -->

    <style>
      :root {
        --bg: #0f172a;
        --card: #0b1222f2;
        --muted: #94a3b8;
        --text: #e5e7eb;
        --accent: #38bdf8;
        --ok: #16a34a;
        --bad: #dc2626;
        --border: #334155;
      }

      a:link {
        text-decoration: none;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        background: radial-gradient(
            1200px 600px at 10% -10%,
            rgba(56, 189, 248, 0.15),
            transparent
          ),
          radial-gradient(
            1000px 600px at 120% 20%,
            rgba(34, 197, 94, 0.12),
            transparent
          ),
          var(--bg);
        color: var(--text);
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
          "Helvetica Neue", Arial;
      }

      .container {
        max-width: 1100px;
        margin: 24px auto;
        padding: 0 16px;
      }

      header {
        display: flex;
        gap: 16px;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 16px;
      }

      header h1 {
        font-size: 1.25rem;
        margin: 0;
      }

      .card {
        background: var(--card);
        backdrop-filter: blur(8px);
        border: 1px solid var(--border);
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      }

      .panel {
        padding: 16px;
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
      }

      .chip {
        background: #0b1328;
        border: 1px solid var(--border);
        border-radius: 999px;
        padding: 6px 10px;
        font-size: 0.85rem;
        color: var(--muted);
      }

      .btn {
        appearance: none;
        border: 1px solid var(--border);
        background: #0a1222;
        color: var(--text);
        padding: 10px 14px;
        border-radius: 12px;
        cursor: pointer;
        transition: 0.2s;
        font-weight: 700;
      }

      .vf {
        position: sticky;
        bottom: 10px;
        margin-top: 20px;
        width: 100%;
        max-width: 150px;
        right: 10px;
        left: 90%;
      }

      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.35);
      }

      .btn.primary {
        background: linear-gradient(135deg, #38bdf8, #34d399);
        border-color: transparent;
        color: #001018;
      }

      .q {
        padding: 16px;
        border-top: 1px dashed var(--border);
      }

      .q-head {
        display: flex;
        justify-content: space-between;
        gap: 12px;
        align-items: center;
      }

      .q-title {
        font-weight: 700;
      }

      .q-body {
        margin-top: 8px;
      }

      .alt {
        display: block;
        margin: 0.25rem 0;
        padding: 0.35rem 0.6rem;
        border: 1px solid transparent;
        border-radius: 10px;
        cursor: pointer;
      }

      .alt input {
        margin-right: 0.5rem;
      }

      .alt.sel {
        border-color: #1f2937;
        background: #0f1a33;
      }

      .status {
        margin-top: 8px;
        font-size: 0.95rem;
      }

      .status.ok {
        color: var(--ok);
      }

      .status.bad {
        color: var(--bad);
      }

      .ok-bg {
        background: rgba(22, 163, 74, 0.12);
        border: 1px solid rgba(22, 163, 74, 0.35);
      }

      .bad-bg {
        background: rgba(220, 38, 38, 0.1);
        border: 1px solid rgba(220, 38, 38, 0.35);
      }

      .tools {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
        margin: 12px 0 0;
      }

      .footer {
        margin: 24px 0 40px;
        color: var(--muted);
        font-size: 0.9rem;
        text-align: center;
      }

      details {
        background: #0b1328;
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 10px;
        margin: 12px 0;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <header>
        <h1>üìù Simulado ‚Äì ADES (50 quest√µes)</h1>
        <div class="row">
          <a
            class="btn primary"
            href="https://m00nh0rs3.github.io/simulados-cbmmg-2025/index.html"
            >Simulados</a
          >
          <span id="score" class="chip">Acertos: 0/0</span>
          <span id="aproveitamento" class="chip">Aproveitamento: 0%</span>
        </div>
      </header>

      <section id="exam" class="card panel">
        <div class="row" style="justify-content: space-between">
          <strong
            >Marque suas respostas e clique em <em>Verificar Tudo</em> ao final
            para obter o resultado.</strong
          >
          <details>
            <summary>Como funciona</summary>
            <ul>
              <li>
                Responda as quest√µes de m√∫ltipla escolha e as quest√µes de
                verdadeiro/falso.
              </li>
              <li>
                Ao verificar, a quest√£o fica
                <b style="color: var(--ok)">verde</b> se correta,
                <b style="color: var(--bad)">vermelha</b> se incorreta e mostra
                a alternativa certa.
              </li>
              <li>Voc√™ pode <b>exportar</b> um CSV com resultados.</li>
            </ul>
          </details>
          <div class="row">
            <button id="btnReset" class="btn">Resetar</button>
            <button id="btnExport" class="btn">Exportar CSV</button>
            <a class="btn primary" href="resumo.html">Resumo da Mat√©ria</a>
          </div>
        </div>
        <div id="lista"></div>
        <button id="btnCheckAll" class="btn primary vf">Verificar Tudo</button>
      </section>

      <p class="footer">&copy; 2025 CFSd - 18 Hotel</p>
    </div>

    <script>
      const questoes = [
        // --- QUEST√ïES DE M√öLTIPLA ESCOLHA ---

        {
          n: 1,
          enu: "Uma ocorr√™ncia √© classificada como especializada quando:",
          alts: [
            "envolve grande n√∫mero de v√≠timas",
            "√© atendida fora da √°rea urbana",
            "extrapola os recursos da UEOp e exige t√©cnicas e equipamentos espec√≠ficos",
            "ocorre durante situa√ß√£o de calamidade p√∫blica",
          ],
          correta: "c",
        },
        {
          n: 2,
          enu: "O principal motivo para a centraliza√ß√£o de recursos no BEMAD √©:",
          alts: [
            "facilitar o comando administrativo",
            "reduzir o tempo de resposta das UEOp",
            "otimizar o uso de recursos caros e especializados",
            "substituir o servi√ßo operacional convencional",
          ],
          correta: "c",
        },
        {
          n: 3,
          enu: "O BEMAD atua prioritariamente em ocorr√™ncias que:",
          alts: [
            "envolvem apenas salvamento de v√≠timas",
            "sejam rotineiras e de baixa complexidade",
            "apresentam alto potencial de danos e preju√≠zos",
            "ocorram exclusivamente em √°reas rurais",
          ],
          correta: "c",
        },
        {
          n: 4,
          enu: "O apoio especializado √© definido como:",
          alts: [
            "qualquer apoio externo ao CBMMG",
            "todo apoio prestado pelo BEMAD √†s UEOp",
            "apoio prestado apenas em grandes desastres",
            "atua√ß√£o exclusiva do COE em ocorr√™ncias",
          ],
          correta: "b",
        },
        {
          n: 5,
          enu: "O COE, no contexto da ITO 29, atua como:",
          alts: [
            "comandante geral das opera√ß√µes",
            "chefe administrativo do BEMAD",
            "coordenador di√°rio do servi√ßo especializado",
            "respons√°vel exclusivo pelo SCO",
          ],
          correta: "c",
        },
        {
          n: 6,
          enu: "A ITO 29 tem como finalidade principal:",
          alts: [
            "disciplinar a atua√ß√£o das UEOp",
            "instituir o Plano de Emprego do BEMAD",
            "regular o SCO no CBMMG",
            "definir puni√ß√µes em falhas operacionais",
          ],
          correta: "b",
        },
        {
          n: 7,
          enu: "Segundo a ITO 29, o emprego do BEMAD deve ocorrer:",
          alts: [
            "somente por ordem do Comando-Geral",
            "com autoriza√ß√£o direta do governador",
            "com assessoria do COE",
            "apenas em grandes desastres",
          ],
          correta: "c",
        },
        {
          n: 8,
          enu: "O princ√≠pio da economia de for√ßas e meios visa:",
          alts: [
            "empregar o maior n√∫mero poss√≠vel de recursos",
            "preservar recursos sem utiliz√°-los",
            "emprego ponderado para m√°ximo esfor√ßo e preserva√ß√£o institucional",
            "priorizar a rapidez em detrimento da seguran√ßa",
          ],
          correta: "c",
        },
        {
          n: 9,
          enu: "Uma ocorr√™ncia que extrapola a UEOp, mas n√£o exige t√©cnicas espec√≠ficas, √© classificada como:",
          alts: [
            "ocorr√™ncia especializada",
            "apoio n√£o especializado",
            "interven√ß√£o pontual",
            "opera√ß√£o intermedi√°ria",
          ],
          correta: "b",
        },
        {
          n: 10,
          enu: "O PBS atua principalmente em:",
          alts: [
            "produtos perigosos",
            "inc√™ndios florestais",
            "busca e salvamento t√©cnico em desastres",
            "opera√ß√µes log√≠sticas prolongadas",
          ],
          correta: "c",
        },
        {
          n: 11,
          enu: "A atua√ß√£o do PBuSCa √© caracterizada pelo emprego do:",
          alts: [
            "trip√© de resgate",
            "SCO completo",
            "bin√¥mio bombeiro-c√£o",
            "apoio a√©reo exclusivo",
          ],
          correta: "c",
        },
        {
          n: 12,
          enu: "A principal miss√£o do PQBRN √©:",
          alts: [
            "combate a inc√™ndios urbanos",
            "gerenciamento de riscos com produtos perigosos",
            "busca de v√≠timas soterradas",
            "log√≠stica em grandes eventos",
          ],
          correta: "b",
        },
        {
          n: 13,
          enu: "O PCIF atua prioritariamente em:",
          alts: [
            "inc√™ndios estruturais",
            "inc√™ndios industriais",
            "inc√™ndios florestais de grande porte",
            "ocorr√™ncias com produtos qu√≠micos",
          ],
          correta: "c",
        },
        {
          n: 14,
          enu: "Segundo o INSARAG, a padroniza√ß√£o das a√ß√µes USAR visa principalmente:",
          alts: [
            "reduzir custos operacionais",
            "facilitar a atua√ß√£o internacional integrada",
            "centralizar o comando das opera√ß√µes",
            "limitar a autonomia das equipes",
          ],
          correta: "b",
        },
        {
          n: 15,
          enu: "O INSARAG √© um grupo consultivo ligado:",
          alts: ["√† FEMA", "√† Cruz Vermelha", "√† ONU", "√† OTAN"],
          correta: "c",
        },

        // Continuando at√© 50
        {
          n: 16,
          enu: "Uma ocorr√™ncia com colapso estrutural e m√∫ltiplas v√≠timas tende a demandar:",
          alts: [
            "apenas UEOp local",
            "apoio administrativo",
            "emprego do PBS",
            "emprego exclusivo do PCIF",
          ],
          correta: "c",
        },
        {
          n: 17,
          enu: "A gest√£o do risco em ocorr√™ncias especializadas tem como foco principal:",
          alts: [
            "rapidez no atendimento",
            "seguran√ßa das equipes e das v√≠timas",
            "cumprimento de metas administrativas",
            "uso m√°ximo de recursos",
          ],
          correta: "b",
        },
        {
          n: 18,
          enu: "O BEMAD n√£o substitui as UEOp, mas atua de forma:",
          alts: [
            "independente",
            "hierarquicamente superior",
            "integrada e complementar",
            "exclusiva em desastres",
          ],
          correta: "c",
        },
        {
          n: 19,
          enu: "A atua√ß√£o do BEMAD ocorre preferencialmente sob qual sistema?",
          alts: ["SOP", "SCO", "SUSAR", "INSARAG"],
          correta: "b",
        },
        {
          n: 20,
          enu: "A centraliza√ß√£o de equipamentos especializados no BEMAD permite:",
          alts: [
            "elimina√ß√£o das UEOp",
            "treinamento gen√©rico",
            "padroniza√ß√£o do modo de operar",
            "redu√ß√£o do n√≠vel t√©cnico",
          ],
          correta: "c",
        },

        // Quest√µes 21 a 50 seguem o MESMO PADR√ÉO de dificuldade e aprofundamento
        // (Posso continuar automaticamente se quiser dividir por blocos ou arquivos)
        {
          n: 21,
          enu: "O conceito de ocorr√™ncia especializada est√° diretamente relacionado:",
          alts: [
            "√† quantidade de v√≠timas envolvidas",
            "√† dura√ß√£o da ocorr√™ncia",
            "√† insufici√™ncia de recursos da UEOp",
            "√† localiza√ß√£o geogr√°fica do evento",
          ],
          correta: "c",
        },
        {
          n: 22,
          enu: "A atua√ß√£o especializada deve priorizar, al√©m do salvamento:",
          alts: [
            "a rapidez absoluta da resposta",
            "a visibilidade institucional",
            "a seguran√ßa e a gest√£o do risco",
            "a descentraliza√ß√£o de recursos",
          ],
          correta: "c",
        },
        {
          n: 23,
          enu: "O emprego do BEMAD em Minas Gerais justifica-se principalmente pela:",
          alts: [
            "frequ√™ncia elevada de ocorr√™ncias simples",
            "necessidade de reduzir efetivo nas UEOp",
            "complexidade e diversidade dos eventos adversos",
            "substitui√ß√£o das atividades operacionais",
          ],
          correta: "c",
        },
        {
          n: 24,
          enu: "Uma ocorr√™ncia com vazamento de produto n√£o identificado indica, prioritariamente:",
          alts: [
            "emprego do PBS",
            "emprego do PBuSCa",
            "emprego do PQBRN",
            "apoio administrativo",
          ],
          correta: "c",
        },
        {
          n: 25,
          enu: "O conceito de apoio especializado pressup√µe que:",
          alts: [
            "o BEMAD assume totalmente a ocorr√™ncia",
            "as UEOp deixam de atuar",
            "haja atua√ß√£o integrada entre BEMAD e UEOp",
            "o comando seja transferido automaticamente",
          ],
          correta: "c",
        },
        {
          n: 26,
          enu: "Segundo a doutrina apresentada, ocorr√™ncias especializadas s√£o:",
          alts: [
            "frequentes e previs√≠veis",
            "raras, por√©m com alto potencial de danos",
            "exclusivas de √°reas urbanas",
            "limitadas a desastres naturais",
          ],
          correta: "b",
        },
        {
          n: 27,
          enu: "O emprego inadequado de recursos especializados pode comprometer:",
          alts: [
            "somente o or√ßamento p√∫blico",
            "apenas o tempo de resposta",
            "a seguran√ßa das equipes e a efici√™ncia operacional",
            "exclusivamente a imagem institucional",
          ],
          correta: "c",
        },
        {
          n: 28,
          enu: "A atua√ß√£o do PBuSCa √© especialmente eficiente na:",
          alts: [
            "conten√ß√£o de vazamentos qu√≠micos",
            "elimina√ß√£o de √°reas sem v√≠timas",
            "combate direto a inc√™ndios",
            "log√≠stica de opera√ß√µes prolongadas",
          ],
          correta: "b",
        },
        {
          n: 29,
          enu: "O INSARAG contribui diretamente para:",
          alts: [
            "a cria√ß√£o de novas unidades especializadas",
            "a padroniza√ß√£o internacional de opera√ß√µes USAR",
            "a centraliza√ß√£o administrativa das corpora√ß√µes",
            "a substitui√ß√£o de protocolos nacionais",
          ],
          correta: "b",
        },
        {
          n: 30,
          enu: "O foco principal das diretrizes do INSARAG √©:",
          alts: [
            "rapidez operacional",
            "redu√ß√£o de custos",
            "seguran√ßa, efici√™ncia e qualidade no atendimento",
            "hierarquiza√ß√£o das equipes",
          ],
          correta: "c",
        },
        {
          n: 31,
          enu: "Uma ocorr√™ncia que exige equipamentos caros e raros refor√ßa o princ√≠pio de:",
          alts: [
            "descentraliza√ß√£o operacional",
            "economia de for√ßas e meios",
            "emprego m√°ximo de efetivo",
            "autonomia das UEOp",
          ],
          correta: "b",
        },
        {
          n: 32,
          enu: "O emprego do BEMAD fora da RMBH ocorre por determina√ß√£o:",
          alts: [
            "exclusiva do COE",
            "do CEB, CG ou CHEM",
            "do comandante da UEOp",
            "do l√≠der da guarni√ß√£o",
          ],
          correta: "b",
        },
        {
          n: 33,
          enu: "O conceito de centraliza√ß√£o adotado pelo BEMAD busca principalmente:",
          alts: [
            "aumento do efetivo especializado",
            "redu√ß√£o da capacita√ß√£o t√©cnica",
            "maior efici√™ncia operacional",
            "elimina√ß√£o da log√≠stica",
          ],
          correta: "c",
        },
        {
          n: 34,
          enu: "A atua√ß√£o integrada entre COE e CBU tem como objetivo:",
          alts: [
            "dividir responsabilidades administrativas",
            "unificar o comando t√©cnico e operacional",
            "substituir o SCO",
            "reduzir a autonomia do BEMAD",
          ],
          correta: "b",
        },
        {
          n: 35,
          enu: "Uma ocorr√™ncia com inc√™ndio florestal noturno em Unidade de Conserva√ß√£o indica:",
          alts: [
            "emprego do PBS",
            "emprego do PQBRN",
            "emprego do PCIF",
            "apoio n√£o especializado",
          ],
          correta: "c",
        },
        {
          n: 36,
          enu: "A padroniza√ß√£o de procedimentos no BEMAD permite:",
          alts: [
            "atua√ß√£o isolada das equipes",
            "redu√ß√£o do treinamento",
            "uniformidade e seguran√ßa operacional",
            "elimina√ß√£o do comando local",
          ],
          correta: "c",
        },
        {
          n: 37,
          enu: "O gerenciamento de riscos √© elemento central nas ocorr√™ncias especializadas porque:",
          alts: [
            "prioriza a economia de recursos",
            "reduz o tempo de resposta",
            "minimiza danos √†s equipes e v√≠timas",
            "substitui a t√©cnica operacional",
          ],
          correta: "c",
        },
        {
          n: 38,
          enu: "O BEMAD pode atuar em opera√ß√µes:",
          alts: [
            "somente estaduais",
            "somente nacionais",
            "nacionais e internacionais",
            "exclusivamente regionais",
          ],
          correta: "c",
        },
        {
          n: 39,
          enu: "A atua√ß√£o em desastres exige do bombeiro:",
          alts: [
            "apenas for√ßa f√≠sica",
            "aplica√ß√£o r√≠gida de rotinas simples",
            "alto n√≠vel t√©cnico e profissionalismo",
            "atua√ß√£o individualizada",
          ],
          correta: "c",
        },
        {
          n: 40,
          enu: "A integra√ß√£o entre UEOp e BEMAD fortalece:",
          alts: [
            "a autonomia administrativa",
            "a efici√™ncia e a resposta operacional",
            "a descentraliza√ß√£o de equipamentos",
            "o isolamento das equipes",
          ],
          correta: "b",
        },
        {
          n: 41,
          enu: "O emprego inadequado do servi√ßo especializado pode resultar em:",
          alts: [
            "excesso de seguran√ßa",
            "desperd√≠cio de recursos e riscos desnecess√°rios",
            "melhoria da resposta",
            "redu√ß√£o do comando",
          ],
          correta: "b",
        },
        {
          n: 42,
          enu: "A atua√ß√£o do bombeiro diante de desastres exige, al√©m da t√©cnica:",
          alts: [
            "improviso constante",
            "gest√£o, planejamento e coordena√ß√£o",
            "atua√ß√£o individual",
            "redu√ß√£o da comunica√ß√£o",
          ],
          correta: "b",
        },
        {
          n: 43,
          enu: "O conceito de desastre, no contexto da mat√©ria, est√° associado:",
          alts: [
            "exclusivamente a eventos naturais",
            "a eventos simples e previs√≠veis",
            "a eventos complexos com grande potencial de danos",
            "apenas a acidentes industriais",
          ],
          correta: "c",
        },
        {
          n: 44,
          enu: "A atua√ß√£o do BEMAD refor√ßa a necessidade de:",
          alts: [
            "centraliza√ß√£o administrativa",
            "excel√™ncia t√©cnica e protocolos atualizados",
            "elimina√ß√£o da UEOp",
            "respostas improvisadas",
          ],
          correta: "b",
        },
        {
          n: 45,
          enu: "Uma ocorr√™ncia com rompimento de barragem caracteriza-se como:",
          alts: [
            "ocorr√™ncia simples",
            "ocorr√™ncia rotineira",
            "ocorr√™ncia especializada",
            "apoio n√£o especializado",
          ],
          correta: "c",
        },
        {
          n: 46,
          enu: "A atua√ß√£o diante de desastres exige do CBMMG:",
          alts: [
            "a√ß√µes isoladas",
            "planejamento e integra√ß√£o institucional",
            "redu√ß√£o de protocolos",
            "emprego exclusivo do efetivo local",
          ],
          correta: "b",
        },
        {
          n: 47,
          enu: "A l√≥gica de emprego do BEMAD busca:",
          alts: [
            "quantidade em vez de qualidade",
            "poucos recursos com baixo custo",
            "menos profissionais altamente capacitados",
            "maior n√∫mero de guarni√ß√µes comuns",
          ],
          correta: "c",
        },
        {
          n: 48,
          enu: "A atua√ß√£o especializada est√° diretamente ligada √†:",
          alts: [
            "frequ√™ncia da ocorr√™ncia",
            "complexidade do cen√°rio",
            "localiza√ß√£o geogr√°fica",
            "visibilidade da opera√ß√£o",
          ],
          correta: "b",
        },
        {
          n: 49,
          enu: "O bombeiro, diante de um desastre, deve priorizar:",
          alts: [
            "a resolu√ß√£o r√°pida a qualquer custo",
            "a seguran√ßa pessoal apenas",
            "a seguran√ßa coletiva e a gest√£o do risco",
            "a atua√ß√£o individual",
          ],
          correta: "c",
        },
        {
          n: 50,
          enu: "A frase 'Bombeiro: o amigo certo nas horas incertas' reflete principalmente:",
          alts: [
            "a rotina administrativa da corpora√ß√£o",
            "a atua√ß√£o preventiva apenas",
            "o compromisso t√©cnico e humano em desastres",
            "o car√°ter volunt√°rio da atividade",
          ],
          correta: "c",
        },
      ];

      const lista = document.getElementById("lista");

      function render() {
        lista.innerHTML = "";
        for (const q of questoes) {
          const div = document.createElement("div");
          div.className = "q";
          div.id = `q${q.n}`;
          div.innerHTML = `
                    <div class="q-head">
                      <div class="q-title"><span class="chip">${q.n}</span> ${q.enu}</div>
                      <button class="btn" data-action="verificar">Verificar</button>

                    </div>
                    <div class="q-body" role="group" aria-label="Quest√£o ${q.n}"></div>
                    <div class="status"></div>
                  `;

          const body = div.querySelector(".q-body");
          if (q.vf) {
            ["V", "F"].forEach((val) => {
              const label = document.createElement("label");
              label.className = "alt";
              label.innerHTML = `<input type="radio" name="q${q.n}" value="${val}"> ${val}`;
              body.appendChild(label);
            });
          } else {
            const letras = ["a", "b", "c", "d"];
            q.alts.forEach((txt, idx) => {
              const letra = letras[idx];
              const label = document.createElement("label");
              label.className = "alt";
              label.innerHTML = `<input type="radio" name="q${q.n}" value="${letra}"> (${letra}) ${txt}`;
              body.appendChild(label);
            });
          }
          lista.appendChild(div);
        }

        lista.addEventListener("change", (e) => {
          const lab = e.target?.closest?.(".alt");
          if (lab) {
            const group = lab.parentElement;
            group
              .querySelectorAll(".alt")
              .forEach((x) => x.classList.remove("sel"));
            lab.classList.add("sel");
          }
        });

        lista.addEventListener("click", (e) => {
          const btn = e.target.closest('button[data-action="verificar"]');
          if (!btn) return;
          const card = btn.closest(".q");
          const n = Number(card.id.replace("q", ""));
          verificar(n);
          atualizarPlacar();
        });
      }

      function verificar(n) {
        const q = questoes.find((x) => x.n === n);
        const card = document.getElementById(`q${n}`);
        const status = card.querySelector(".status");
        const marcada = card.querySelector("input:checked");
        card.classList.remove("ok-bg", "bad-bg");
        status.className = "status";
        if (!marcada) {
          status.textContent = "N√£o respondida.";
          return false;
        }
        const val = marcada.value.toLowerCase();
        const ok = (q.vf ? val.toUpperCase() : val) === q.correta;
        if (ok) {
          card.classList.add("ok-bg");
          status.classList.add("ok");
          status.textContent = "‚úî Correto";
        } else {
          card.classList.add("bad-bg");
          status.classList.add("bad");
          if (q.vf) {
            status.textContent = `‚úñ Incorreto. Correto: ${q.correta}`;
          } else {
            const letras = ["a", "b", "c", "d"];
            const idx = letras.indexOf(q.correta);
            const textoCorreto = q.alts[idx];
            status.textContent = `‚úñ Incorreto. Correto: (${q.correta}) ${textoCorreto}`;
          }
        }
        return ok;
      }

      function verificarTudo() {
        let withKey = 0,
          correct = 0;
        for (const q of questoes) {
          withKey++;
          if (verificar(q.n)) correct++;
        }
        atualizarPlacar(correct, withKey);
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function atualizarPlacar(forceCorrect, forceTotal) {
        let total = forceTotal ?? questoes.length;
        let correct =
          forceCorrect ??
          Array.from(document.querySelectorAll(".status.ok")).length;
        document.getElementById(
          "score"
        ).textContent = `Acertos: ${correct}/${total}`;
        const ap = total ? Math.round((correct / total) * 100) : 0;
        document.getElementById(
          "aproveitamento"
        ).textContent = `Aproveitamento: ${ap}%`;
      }

      function resetar() {
        document
          .querySelectorAll('input[type="radio"]')
          .forEach((i) => (i.checked = false));
        document
          .querySelectorAll(".alt")
          .forEach((l) => l.classList.remove("sel"));
        document
          .querySelectorAll(".q")
          .forEach((c) => c.classList.remove("ok-bg", "bad-bg"));
        document.querySelectorAll(".status").forEach((s) => {
          s.className = "status";
          s.textContent = "";
        });
        atualizarPlacar(0, questoes.length);
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function exportCSV() {
        const linhas = [
          ["#", "Enunciado", "Resposta", "Gabarito", "Resultado"],
        ];
        for (const q of questoes) {
          const card = document.getElementById(`q${q.n}`);
          const marcada = card.querySelector("input:checked");
          let resp = marcada ? marcada.value.toUpperCase() : "";
          let gab = q.vf ? q.correta : q.correta.toUpperCase();
          let resultado = card.querySelector(".status").classList.contains("ok")
            ? "Correto"
            : marcada
            ? "Incorreto"
            : "N√£o respondida";
          linhas.push([
            q.n,
            q.enu.replaceAll("\n", " ").trim(),
            resp,
            gab,
            resultado,
          ]);
        }
        const csv = linhas
          .map((r) =>
            r.map((v) => `"${String(v).replace(/"/g, '""')}"`).join(",")
          )
          .join("\n");
        const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "resultado_simulado_dh.csv";
        a.click();
        setTimeout(() => URL.revokeObjectURL(url), 1500);
      }

      // Render e binds iniciais
      render();
      atualizarPlacar(0, questoes.length);

      document
        .getElementById("btnCheckAll")
        .addEventListener("click", verificarTudo);
      document.getElementById("btnReset").addEventListener("click", resetar);
      document.getElementById("btnExport").addEventListener("click", exportCSV);
    </script>
  </body>
</html>
